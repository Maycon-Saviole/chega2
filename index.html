<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHEGA! - Seguran√ßa Pessoal</title>
    <style>
        /* RESET COMPLETO - SEM ANIMA√á√ïES AUTOM√ÅTICAS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            transition: background-color 0.5s; /* Transi√ß√£o suave apenas */
        }
        
        .container {
            max-width: 800px;
            width: 100%;
        }
        
        .logo {
            font-size: 3em;
            margin-bottom: 10px;
        }
        
        .tagline {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 30px;
        }
        
        /* BOT√ÉO SIMPLES E FUNCIONAL */
        #emergencyBtn {
            background: #ff0000;
            color: white;
            border: none;
            border-radius: 50%;
            width: 200px;
            height: 200px;
            font-size: 1.8em;
            font-weight: bold;
            cursor: pointer;
            margin: 30px auto;
            display: block;
            transition: transform 0.2s;
            position: relative;
            overflow: hidden;
        }
        
        #emergencyBtn:hover {
            transform: scale(1.05);
        }
        
        #emergencyBtn:active {
            transform: scale(0.95);
        }
        
        .btn-text {
            font-size: 1.5em;
            margin-bottom: 5px;
        }
        
        .btn-subtext {
            font-size: 0.6em;
            opacity: 0.8;
        }
        
        /* Status */
        .status {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        /* Bot√µes de a√ß√£o */
        .action-btn {
            background: #4cd964;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            display: inline-block;
        }
        
        .test-btn {
            background: #ff9500;
        }
        
        footer {
            margin-top: 40px;
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        /* Para celular */
        @media (max-width: 600px) {
            #emergencyBtn {
                width: 180px;
                height: 180px;
                font-size: 1.6em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="logo">üö® CHEGA!</h1>
        <p class="tagline">Seguran√ßa pessoal para mulheres</p>
        
        <!-- BOT√ÉO PRINCIPAL - SIMPLES -->
        <button id="emergencyBtn">
            <div class="btn-text">CHEGA!</div>
            <div class="btn-subtext">Clique para emerg√™ncia</div>
        </button>
        
        <p style="margin: 20px; opacity: 0.8;">
            üí° Segure por 3 segundos para ativa√ß√£o r√°pida
        </p>
        
        <!-- Status do sistema -->
        <div class="status">
            <div style="margin: 10px 0;">
                <span>üîä Som:</span>
                <span id="soundStatus">‚úÖ Pronto</span>
            </div>
            <div style="margin: 10px 0;">
                <span>üí° Flash:</span>
                <span id="flashStatus">‚úÖ Dispon√≠vel</span>
            </div>
        </div>
        
        <!-- A√ß√µes -->
        <div style="margin: 30px 0;">
            <button class="action-btn test-btn" onclick="testEmergency()">
                üß™ Testar Emerg√™ncia
            </button>
            <button class="action-btn" onclick="window.location.href='contacts.html'">
                üë• Contatos
            </button>
        </div>
    </div>
    <!-- Menu de navega√ß√£o completo -->
<div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 30px 0;">
    <button onclick="window.location.href='trip.html'" class="nav-btn">
        <span class="nav-icon">üìç</span>
        <span class="nav-text">Acompanhamento</span>
    </button>
    
    <button onclick="window.location.href='contacts.html'" class="nav-btn">
        <span class="nav-icon">üë•</span>
        <span class="nav-text">Contatos</span>
    </button>
    
    <button onclick="window.location.href='community.html'" class="nav-btn">
        <span class="nav-icon">ü§ù</span>
        <span class="nav-text">CHEGA+</span>
    </button>
    
    <button onclick="window.location.href='about.html'" class="nav-btn">
        <span class="nav-icon">‚ÑπÔ∏è</span>
        <span class="nav-text">Sobre/Doa√ß√µes</span>
    </button>
</div>

<style>
    .nav-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
        padding: 20px 10px;
        border-radius: 15px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        transition: all 0.3s;
    }
    
    .nav-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-3px);
    }
    
    .nav-icon {
        font-size: 1.8em;
    }
    
    .nav-text {
        font-size: 0.9em;
    }
</style>
    <footer>
        <p>Desenvolvido com ‚ù§Ô∏è por um pai e professor</p>
        <p>Gratuito ‚Ä¢ Seguro ‚Ä¢ Para todas</p>
    </footer>

    <script>
        // =========== SISTEMA CONTROLADO ===========
        
        // Estado global para controlar tudo
        window.chegaApp = {
            emergencyActive: false,
            audioContext: null,
            oscillator: null,
            flashInterval: null,
            vibrationInterval: null
        };
        
        // =========== BOT√ÉO DE EMERG√äNCIA ===========
        document.getElementById('emergencyBtn').addEventListener('click', function() {
            if (!window.chegaApp.emergencyActive) {
                activateEmergency();
            }
        });
        
        // =========== FUN√á√ÉO PRINCIPAL ===========
        function activateEmergency() {
            if (window.chegaApp.emergencyActive) return;
            
            // Marcar como ativa
            window.chegaApp.emergencyActive = true;
            console.log('üö® EMERG√äNCIA ATIVADA');
            
            // 1. EFEITO VISUAL R√ÅPIDO (flash uma vez)
            flashScreen();
            
            // 2. TOCAR SIRENE (controlada)
            playSiren();
            
            // 3. VIBRAR (se dispon√≠vel)
            vibrate();
            
            // 4. REDIRECIONAR PARA TELA DE EMERG√äNCIA
            setTimeout(() => {
                // PARAR TUDO antes de redirecionar
                stopAllEffects();
                
                // Ir para tela de emerg√™ncia
                window.location.href = 'emergency.html?t=' + Date.now();
            }, 1000);
        }
        
        // =========== FLASH DA TELA (UMA VEZ S√ì) ===========
        function flashScreen() {
            // Flash r√°pido (vermelho ‚Üí branco ‚Üí vermelho)
            let flashCount = 0;
            const maxFlash = 3; // Apenas 3 flashes
            
            function flash() {
                if (flashCount >= maxFlash) {
                    document.body.style.backgroundColor = '';
                    return;
                }
                
                if (flashCount % 2 === 0) {
                    document.body.style.backgroundColor = '#ffffff';
                } else {
                    document.body.style.backgroundColor = '#ff0000';
                }
                
                flashCount++;
                setTimeout(flash, 200);
            }
            
            flash();
        }
        
        // =========== SIRENE REAL E CONTROLADA ===========
        function playSiren() {
            try {
                // Criar contexto de √°udio
                window.chegaApp.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                window.chegaApp.oscillator = window.chegaApp.audioContext.createOscillator();
                const gainNode = window.chegaApp.audioContext.createGain();
                
                // Conectar
                window.chegaApp.oscillator.connect(gainNode);
                gainNode.connect(window.chegaApp.audioContext.destination);
                
                // Configurar sirene
                window.chegaApp.oscillator.type = 'sawtooth';
                gainNode.gain.value = 0.2; // Volume baixo para teste
                
                // Frequ√™ncia oscilante
                let time = window.chegaApp.audioContext.currentTime;
                window.chegaApp.oscillator.frequency.setValueAtTime(800, time);
                window.chegaApp.oscillator.frequency.exponentialRampToValueAtTime(1600, time + 0.5);
                window.chegaApp.oscillator.frequency.exponentialRampToValueAtTime(800, time + 1);
                
                // Iniciar sirene
                window.chegaApp.oscillator.start();
                
                // Parar automaticamente ap√≥s 3 segundos
                window.chegaApp.oscillator.stop(time + 3);
                
                console.log('üîä Sirene ativada por 3 segundos');
                
            } catch (error) {
                console.log('√Åudio n√£o dispon√≠vel:', error);
                // Fallback: alerta sonoro do navegador
                try {
                    const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQ');
                    audio.volume = 0.1;
                    audio.play();
                } catch (e) {
                    console.log('Fallback de √°udio tamb√©m falhou');
                }
            }
        }
        
        // =========== VIBRA√á√ÉO CONTROLADA ===========
        function vibrate() {
            if (navigator.vibrate) {
                // Vibrar apenas por 2 segundos
                navigator.vibrate(2000);
                console.log('üì≥ Vibra√ß√£o ativada por 2 segundos');
            }
        }
        
        // =========== PARAR TODOS OS EFEITOS ===========
        function stopAllEffects() {
            console.log('üõë Parando todos os efeitos...');
            
            // Parar sirene
            if (window.chegaApp.oscillator) {
                try {
                    window.chegaApp.oscillator.stop();
                } catch (e) {}
            }
            
            if (window.chegaApp.audioContext) {
                try {
                    window.chegaApp.audioContext.close();
                } catch (e) {}
            }
            
            // Parar vibra√ß√£o
            if (navigator.vibrate) {
                navigator.vibrate(0);
            }
            
            // Parar flashes
            if (window.chegaApp.flashInterval) {
                clearInterval(window.chegaApp.flashInterval);
            }
            
            // Restaurar fundo
            document.body.style.backgroundColor = '';
            
            // Resetar estado
            window.chegaApp.emergencyActive = false;
        }
        
        // =========== TESTE SEGURO ===========
        function testEmergency() {
            if (confirm('üß™ Testar sistema de emerg√™ncia?\n\nIsto ir√°:\n‚Ä¢ Piscar a tela 3x\n‚Ä¢ Tocar sirene por 3 segundos\n‚Ä¢ Vibrar (se suportado)\n\n√â apenas um teste.')) {
                activateEmergency();
            }
        }
        
        // =========== VERIFICAR SE VOLTOU DE EMERG√äNCIA ===========
        window.addEventListener('load', function() {
            // Verificar URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('cancelled') === 'true') {
                alert('‚úÖ Emerg√™ncia cancelada com sucesso!');
                
                // Remover par√¢metro da URL
                window.history.replaceState({}, document.title, window.location.pathname);
            }
            
            // Garantir que n√£o h√° efeitos ativos
            stopAllEffects();
        });
        
        // =========== DETECTAR SA√çDA DA P√ÅGINA ===========
        window.addEventListener('beforeunload', function() {
            stopAllEffects();
        });
    </script>
</body>
</html>
